<!DOCTYPE html>
<html lang="en">
    <head>
	<meta charset="utf-8">
	<link rel="shortcut icon" href="%PUBLIC_URL%/favicon.png">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="theme-color" content="#000000">
	<link rel="manifest" href="%PUBLIC_URL%/manifest.json">
	<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
	<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
	<script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
	<!-- <link href="custom.css" rel="stylesheet"> -->
	<link href="{{ url_for('static', filename='custom.css') }}" rel="stylesheet"/>

	<link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />
	<title>MCF: Event Registration Page</title>
    </head>
    <body>

	
	<div class="container mx-auto">
	    
	    {% block nav %} 
	    {% endblock %}


	    
	    {% block form %} 
	    {% endblock %}
	</div>

	<script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>

	<script>


/* bulk_upload_all_files_1 */




/* function initialise() {
   myFunction();
   anotherFunction();
   } */



// NOTE-TO-SELF: from a syntax POV, jquery onready consuses, where function has no ()
/* $(document).ready(initialise); */

	 


function submitPartDownloadForm(){
    var selValue = document.getElementById("downloadOffset").value;
    console.log(selValue)
    if (selValue != -1){
	document.partialDownload.submit();
    }
}


function submitFormCreator(){
    const text = `
Creating a new form will remove
all form derived data of specific event:
 - all members answers of that event
 - all form questions of that event
	     Continue?`;
    
    if (confirm(text) == true){
	return true;
    }else{
	return false;
    }
}


function confirmWithAJAX(message, callback){

    var dialog = $('<div>').dialog({
        modal: true,
        title: 'Confirmation',
        buttons: {
          'OK': function() {
            var inputValue = input.val();
            $(this).dialog('close');
            callback(true, inputValue); // Pass true and input value on OK
          },
          'Cancel': function() {
            $(this).dialog('close');
            callback(false); // Pass false on Cancel
          }
        }
    });
	

}




$(document).ready(function(){
    /* alert("asd"); */
    var frm = $("#formCreator");
    /* frm.hide(); */
    
    // removeClass("border-none").addClass("border-3").addClass("border-red-600");
    
    
    frm.on("submit", function(event){
	event.preventDefault();
	     stringVal = frm.find('#formCreateID_field').val();
	     if (typeof stringVal !== 'undefined'){
	    if(stringVal.includes(" ")){
		// alert("field cant contain space, make it memorable")
		$('#field').removeClass("border-none").addClass("border-3").addClass("border-red-600");
		$('#formCreatorInputInvalid').html(" <p>field should not contain spaces.</p> ").removeAttr("hidden");		     
		id="formCreatorInputInvalid"
	    }else{
		$(this).unbind("submit")
	    }
	}
	
    });
    






});



$(window).on('load', function() {
    var choiceCount = $( "#tournament_name option" ).length
    console.log(choiceCount)
    if (choiceCount == 0){
	/* $('#memberEventForm button').hide()		  */
	$('#eventDeleteButton').hide();
	$('#eventSaveButton').hide();
	// $('#fillFormButton').hide();
	
	
	
	
	/* if (frm.email.type === 'text') {
	   frm.onsubmit = function () {
	   if (/\s/.test(frm.email.value)) {
	   // Tell your user the field is invalid here, e.g.
	   frm.email.className = 'invalid';
	   
	   // Prevent form submission
	   return false;
	   }
	   }
	   } */
	
    }
    
    
    
    // $('input[type=radio]')
    $("input[type='radio'][id^='subgroup']") .click(function() {
	console.log($(this).val())
	var subgroupId = $(this).data('action-subgroup-id');
	if($(this).val() === "Yes"){
	    $("#" + subgroupId).show();	    
	}else{
	    $("#" + subgroupId).hide();	    
	}
	
	// console.log('Subgroup ID:', subgroupId);
    });





    $('#formCreateID_subgroupName').prop('disabled', true);
    $('#formCreateID_subgroupButton').prop('disabled', true);

    $('#formCreateID_type').on('change', function(){
	if (this.value == "subgroup radio"){	    
	    $('#formCreateID_subgroupName').prop('disabled', false)
	    $('#formCreateID_addButton').prop('disabled', true)
	    $('#formCreator #formCreateID_value').hide()
	    $('#formCreateID_subgroupButton').prop('disabled', false);
	}else{
	    $('#formCreateID_subgroupName').prop('disabled', true)
	    $('#formCreateID_addButton').prop('disabled', false)
	    $('#formCreator #formCreateID_value').show()
	    $('#formCreateID_subgroupButton').prop('disabled', true);
	}
    });


let preventDefaultFlag = true;
let wDrawString = "";
$('#eventDeleteButton').click(function(e){
    preventDefaultFlag = true
    e.preventDefault();
    function getClause(){	    
	return $.ajax({
	    // type: 'POST',
	    url: '/a-test1', // Replace 'my_view' with your URL name
	    data: {"eventId": $('#tournament_name').val()},
	    // dataType: 'text',
	});
    }
    function handleClause(data){
	if (data == null || data === ""){
	    $('#eventDeleteButton').unbind("click")
	    $('#eventDeleteButton').click(); /* trigger click of button, our days long struggle was this simple, we dont know this */
	}else{
	    $('#confirmWithdrawalText').html(data)
	    $('#confirmWithdrawal').show()
	    my_confirm(function(continueClick) {
		if (continueClick){		    
		    $('#eventDeleteButton').unbind("click")
		    $('#eventDeleteButton').click(); /* trigger click of button, our days long struggle was this simple, we dont know this */
		}else{
		    
		}
	    });
	    
	}
    }
    getClause().done(handleClause)	
    
});



function my_confirm(confirmCallback, cancelCallback) {
    // your confirm dialog	
    $(document).on( 'click', '#confirmWithdrawal #confirmWithdrawalButton', function() {
	// if(typeof confirmCallback === 'function') {
	//     confirmCallback();
	// }
	console.log("clicked confirm");
	$('#confirmWithdrawal').hide();
	confirmCallback(true);
    });
    $(document).on( 'click', '#confirmWithdrawal #cancelWithdrawalButton', function() {
	// if(typeof confirmCallback === 'function') {
	//     confirmCallback();
	// }
	console.log("clicked confirm");
	$('#confirmWithdrawal').hide();
	confirmCallback(false);
    });
	     cancelWithdrawalButton
	 }    
	     
	     
	     
	     
	 }); 







	</script>

	


    </body>
</html>

